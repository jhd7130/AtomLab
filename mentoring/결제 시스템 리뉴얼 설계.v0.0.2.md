![IMG_1018BB2B750F-1](https://user-images.githubusercontent.com/78134917/177107879-c68dd160-aec3-42e7-8bd0-baf2d8bc7f39.jpeg)
## 요구사항
금융 이벤트가 진행 예정이다. 진행되기 전에 대비를 해야한다. 초당 1000건의 결제 요청이 발생할 것으로 예상된다. 어떻게 할 것인가?

## Point
- 결제 프로세스에 대한 이해  
- PG사 서버의 결제처리 성능(초당 100건의 한계)  
- 결제건이기 때문에 데이터의 일괄성이 중요하고 절대 손실이 발생하면 안된다.   

## 설계
- 요청에 대해 저장할 테이블을 설계한다. 
- 요청을 우선적으로 DB에 저장하고 순서를 보장할 수 있는 속성을 두고 요청 순서를 저장한다.(이는 마치 데이터베이스의 테이블을 하나의 queue방식으로 사용하는 것이다.) 
- 순서에 맞춰 FIFO로 요청정보를 꺼내어 PG사로 결제요청을 보낸다. 만약 10대의 서버가 있다면 10대의 서버에서 처리할 수 있는 건수를 10건으로 제한하는 Throtling 기법 사용(서버들이 한번에 처리 가능한 대수가 100건)하여 PG서버가 감당 가능하게 요청을 보낸다. 
- 사용자에게는 결제 성공을 우선적으로 반환하고 만약 결제가 실패할 경우 Push를 사용하여 실패에 대한 알림을 준다.(서버가 다운되는 것보다 이러한 방식을 채택하는게 더 나아 보인다.)  
