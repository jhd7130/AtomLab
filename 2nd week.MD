# 2주차 과제  
  

## 목차  

1. [Process & Thread](##-1.Process-와-Thread-개념)
2. [Multi Process & Multi Thread](##-Multi-Process-&-Multi-Thread)
3. Java 메모리구조
4. Java Collection Framwork
5. Garbage Collector  
</br> 

## 1. Process 와 Thread 개념  
  
    
프로세스와 쓰레드의 개념을 알기전 program에 대해서 정의내려보도록 하자.  
**Program** : 어플리케이션을 실행하기 위해 필요한 명령어와 데이터들의 집합 --> 프로그램을 실행하기 위해 필요한 코드들의 집합(없으면 절대 실행못함)  

**Process** : 실행중에 있는 프로그램을 의미 --> 운영체제가 프로그램을 실행하기위해 하나의 프로그램을 위한 메모리공간 할당, 이 메모리 공간에 프로그램의 바이너리 코드가 올라가는 순간 부터 프로그램은 프로세스로 변신  

**Thread** : 프로세스의 자원을 가지고 실제로 작업하는 가장 작은 단위를 의미 --> 프로세스의 경우 영역으로 보고 내부에서 실제 일을 작업하는 단위를 Thread라고 부른다. 이 쓰레드가 여러개이면 멀티쓰레드라고 부른다.  

하나의 예시로 이 세개의 관계를 정의내려보자.  
메드포갈릭이라는 브랜드의 주방을 생각해보자. 매드포 갈릭에 주방이라는 하나의 공간을 스테이크를 위한 공간, 파스타를 위한 공간, 설거지를 위한 공간으로 나누고 각각의 공간에서 진행할 작업에 필요한 도구 및 재료들을 모두 준비해 놓았다.(프로그램). 그리고 각각의 공간에 사람들이 재료와 도구를 모두 준비해서 요리할 준비를 마쳤고 누군가 지시를 내리면 모든 지시를 잘 받아 음식을 바로 내놓을 수 있다.(프로세스) 립아이 스테이크 주문이 들어왔다. 조수가 립아이 소고기를 가져온다.(쓰레드) 사수가 고기를 굽는다.(쓰레드) 다 구운 고기를 접시에 플레이팅 한다.(쓰레드)  

스테이크를 위한 프로세스 안에서 각각의 작업들은 쓰레드가 된다. 하나의 언어에서 정의 내리기보단 CS의 개념 자체로 이해하는게 좋을 것 같다.  

### 1-1. Process
운영체제는 프로그램을 프로세스로 위치시킬 때 프로세스를 위한 메모리 공간을 할당한다고 했다. 그럼 이 메모리 공간은 어떻게 생겼고 왜 각각의 공간이 나눠졌을까?  
  
총 네가지의 영역으로 나눠니다. (소스코드영역, Heap영역, Stack영역, Data영역)

![image](https://user-images.githubusercontent.com/78134917/154800302-6e08186b-ed30-4e38-8142-2aa50a16ef1b.png)  
![image](https://user-images.githubusercontent.com/78134917/154800330-9b93b217-fec6-470b-821f-5cd665e43166.png)  

하나씩 간단하게 보자  
Program Code : 프로그램의 소스코드가 존재하는 공간이다. 이곳에 프로그램 코드가 올라오면 프로그램은 프로세스가 된다.  
Data : 전역 변수와 Static 변수가 저장되는 공간이다. 프로그램 시작과 동시에 할당되고 종료와 동시에 해제된다.  ]
Stack : 프로그램이 자동으로 생성하는 메모리 영역, 함수 호출시 필요한 지역변수와 매개변수를 저장해 놓는 공간이다. 함수호출이 완료되면 사라진다.  
Heap : 개발자가 조작하는 메모리, 동적할당을 위한 메모리영역이라고도 한다.  

여기서 주의해야하는 것은 stack과 heap은 같은 메모리 공간을 공유한다. stack은 아래서부터 Heap은 위에서 부터 공유하는 메모리 영역을 사용한다. 이 두 공간이 서로의 메모리 영역을 넘어서게되면 Stack overflow나 heap overflow가 발생하게된다.  

### 1-2 Thread
하나의 프로세스는 여러개의 쓰레드로 구성이 가능한다.(기본적으로 프로세스는 하나 이상의 쓰레드로 구성되어 있으며 두개 이상의 쓰레드가 있는 프로스세를 멀티 쓰레드 프로세스라한다.)  
쓰레드는 개별적으로 Stack영역을 가지며 나머지 Heap, Method 영역은 프로세스와 다른 쓰레드들과 공유한다.

이론적인 부분에서 잠시 떨어져 현실적인 부분에서 쓰레드를 설명한다면 어떻게 설명할 수 있을까? 내 생각은 트랜잭션과 비슷하게 작업단위라 생각하면 쉬울 것이라 생각했다. 멀티 쓰레딩을 한다는 것 또한 같다고 본다. 세개의 작업이 있다. 한 사람이 세개의 작업을 한 작업씩 끝낸다면 너무 좋지만 우리에겐 우선순위라는 것이 있다. A의 작업에서는 a작업이 먼저 완료되야하고 B의 작업에서의  a 작업은 A의 b라는 작업보다 먼저 완료되어야 한다고 가정하면 한 사람이 이 모든 작업을 완벽하게 끝내는 것은 불가능하다. 반면에 세가지 일을 세명의 작업자가 각각 작업한다면 어떻게될까? 작업이 번갈아 가면서 이루어진다 하더라도 A작업자는 A작업에 대한 것만 기억하고 수행하면 되기 때문에 훨씬 효율적일 것이다. 
![image](https://user-images.githubusercontent.com/78134917/154801285-4a062033-ba9c-46ad-bce2-98354fae2025.png)  

프로세스와 같이 실행, 대기, 준비 상태를 가진다. 실행 상태가 변할때 마다 **Context Switching(문맥교환)** 을 실행한다.  
위 그림처럼 쓰레드는 각 쓰레드마다 register와 Stack의 영역을 가지는 이유는 뭘까?  

스택은 함수 호출 시 전달되는 인자, 되돌아갈 주소값 및 함수 내에서 선언하는 변수 등을 저장하기 위해 사용되는 메모리 공간이므로 스택 메모리 공간이 독립적이라는 것은 독립적인 함수 호출이 가능하다는 것이고 이는 독립적인 실행 흐름이 가능하게 한다.
따라서 독립적인 실행 흐름을 위한 최소 조건으로 독립된 스택을 할당한다.  

PC 값은 쓰레드가 명령어의 어디까지 수행하였는지를 나타나게 된다.  
쓰레드는 CPU를 할당받았다가 스케줄러에 의해 다시 선점당한다. 그렇기 때문에 명령어가 연속적으로 수행되지 못하고 어느 부분까지 수행했는지 기억할 필요가 있다. 따라서 PC 레지스터를 독립적으로 할당한다.  

단, 여러개의 쓰레드가 존재한다고 해서 하나의 cpu를 가진 컴퓨터에서 여러개의 쓰레드를 동시에(한번에) CPU에 할당할 수 없다. 그렇다면 여러개의 쓰레드는 어떻게 작동될까?  
우선, 프로세스가 생성되면서 메인 쓰레드가 하나 생성되고 나머지 쓰레드는 그 이후에 생겨난다. 추가로 쓰레드를 생성하지 않으면 메인 쓰레드에서 모든 작업들이 실행된다.  


## Multi Process & Multi Thread
멀티 쓰레드의 기본적인 개념 같은 경우에는 위의 글과 같이 하나의 프로세스 안에 여러개의 쓰레드가 존재하는 것을 의미합니다. 멀티 쓰레드는 멀티 프로세스의 비효율적인 면을 개선해 줌으로 우선 멀티 프로세스의 개념과 단점을 먼저 살펴보겟습니다.  

멀티 프로세스의 경우 우리가 컴퓨터에 여러개의 프로그램을 띄워놓는 것과 같다. 여러개의 프로그램이 동시에 실행되고 있는 것 처럼 보이지만 각 프로세스에서 사용자가 사용한 기능만 실행되고 대기 상태로 돌아가게된다.  

여기서 프로세스를 여러개 띄워놓고 하나의 프로세스에서 다른 프로세스로 전환하게 되면 context switching이라는 작업이 실행되게 된다. 
