## #1. 네트워크의 종류 
네트워크를 크게 두 분류로 나누면 LAN과 WAN으로 나눌 수 있다. 이 두가지의 정의를 내려보자.  
일반적으로 두가지를 구분할 때 지역성을 따진다. 작은 범위는 LAN 넓은범위는 WAN으로 알고 있다. 이 개념을 조금더 논리적으로 구분해보자.  
두가지 네트워크를 구분하기 전에 H/W는 물리적인 영역(physical), S/W는 논리적인 영역(logical)으로 정의한다.  
  
LAN은 물리적인 영역에서 이루어지는 통신을 다루는 네트워크이다. 식별자를 MAC주소로 사용한다. LAN의 영역은 BroadCast까지  
   
WAN은 논리적인 영역에서 이루어지는 통신을 다루는 네트워크이다. 식별자를 IP주소로 사용한다. Interne이 대표적인 WAN의 종류이다.  

## #2. 패킷의 생성원리  
이전에 네트워크의 데이터 단위에 대해서 이야기한 적이 있다. Application에서 인터넷으로 보낼 데이터를 Streame단위로 Socket에 보내면 TCP는 Segemnet단위로 Stream을 인캡슐레이션한다. 그럼 해당 Segemnet를 IP에서 packet단위로 인캡슐레이션하고 NIC에서 Frame으로 인캡슐레이션한다. 여기서 중요하게 봐야할게 Packet이다. Stream을 1470byte단위로 Segementation하고 헤더를 붙이면 packet이된다. Packet은 헤더와 페이로드로 구성되어 있고 헤더는 IP계층 정보(20byte)와 TCP 계층 정보(20byte)로 구성되어있다. 페이로드는 내용물로 1470byte으 크기를 차지한다.  

패킷을 생성하는 것을 택배 발송의 일련의 과정으로 비유해도 좋다. 테이블을 보낸다고 해보자. 테이블이 너무 커서 모든걸 한번에 보내지 못하고 부분적으로 포장하여 발송한다. 이게 Stream을 Segementation하는 과정이다. 그럼 이렇게 나눈 택배에 송장을 붙이게된다. 택배는 모두 따로 포장되었지만 목적지는 같다. Packet의 헤더내용이 모두 같다고 보면된다. 그리고 이 택배들을 택배차에 실는다. 이과정이 Packet을 Frame에 인캡슐레이션화 하는 과정이다. 

## #3. IP헤더
![image](https://user-images.githubusercontent.com/78134917/175241150-18da5c06-174f-4918-8d12-5607e16c6579.png).   
version : 인터넷프로토콜의 버전  
HDL : 헤더의 길이  
Total Length : 총길이  
Bit Time to Live : 얼마나 살수있는가에 대한 이야기 라우터를 지날때마다 하나씩 감소 이게 0이되면 라우터는 패킷을 버린다.(32bit로 총 0~255까지 설정 가능)  
Protocal : 상위 프로토콜이 또 존재하는지 6이면 TCP확인, 한꺼풀 더 벗겨낸다. 

## #4. WireShark의 동작원리  
WireShark는 두가지로 구분되어 진다. 패킷이 이더넷 Frame에 쌓여저서 인터넷에서 NIC로 들어오면(Inbound, 나가면 Outbound) IP와 Driver사이에 Sensor(WinPcap)를 놓고 Bypass 시키면서 패킷을 수집한다. 수집한 패킷을 Wireshark GUI로 보내고 그 패킷을 분석한다. 


## #5. 네트워크의 구조 (Inline 구조(= Router), Out of Path 구조)
Inline과 Out of Path 구조를 나눌 때 다루는 데이터 단위의 패킷이다.   

방화벽과 라우터는 둘다 L3 스위치에 속하고, IP로 통신합니다. 내부적으로 라우터는 by_pass인지 drop인지를 결정하고 어디로 패킷을 보낼지를 지정해줍니다(이 두 과정을 inline 처리라고 합니다) . 패킷을 전송할 때 NIC 수준에서 바로 전송하느냐, IP(L3) 수준에서 처리한 이후 전송하느냐, 사용자 프로세스 수준에서 처리한 이후 전송하느냐에 따라서 라우터는 처리속도가 달라집니다. 기본적으로 low level에서 처리할 수록 빠릅니다. 방화벽이라는 것 또한 L3 스위치의 일종인데, 이친구는 보안적인 이유로 by_pass와 drop을 결정합니다. 기본적으로 내부구조는 거의 동일한데, 판단기준이 라우팅용인가 보안 관리용인가 차이가 있습니다.  
  
Out of Path : 간단히 성능을 책정하기 위한 Sesor 스위치를 두는 구조를 이야기한다. L2 Distribution스위치를 지나가는 패킷을 복사하는(미러링) 스위치를 놓는다. 그리고 이 스위치는 패킷을 검사하는 역할을 수행한다. 하지만 패킷 미러링의 경우 엄청난 자원을 소모한다. 따라서 L2 Distribution스위치가 모든 역할을 수행하기  보다는 Tab 스위치라는 미러링만 수행하는 스위치를 라우터와 L2 Distribution스위치 사이에 두고 많이 사용한다.  

## #6. Proxy
usermode application proxy(stream socket통신)구조   
Inline + Out of Packet(packet 통신) 구조  

**proxy의 구동 방식**  
요청자가 정보를 application proxy 서버로 보내면 inbound되어 들어온다. socket을 통해 stream 데이터를 분석하고 목적 서버가 있음을 확인하고 나면 다른 socket에 Stream을 쓰고 목적 서버로 전송한다.  
  
**proxy구조의 활용 1번 : 우회**  



